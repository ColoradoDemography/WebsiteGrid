<!DOCTYPE html>
<html>
<head>
<title>Colorado State Demography Office Home Page</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- FONT AWESOME CSS  Source for buttons the list of icons is here: https://fontawesome.com/icons?d=gallery&p=2 -->
<!-- angle-down, angle-double-down, angle-circle-down, angle-right, angle-circle-right, the new button is in common.css --> 
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.1/css/all.css" crossorigin="anonymous">
<!-- SDO CSS -->
<link type="text/css" rel="stylesheet" href="./assets/css/common.css" async=""> 

<!-- adding d3.js  for data manipulation-->
 <script src="https://d3js.org/d3.v6.min.js"></script>
<!-- SDO suport functions, genSYA, insertHTML, -->
<script src="./assets/js/funct.js"></script>
</head>

<body>

<div>
<a href="https://cdola.colorado.gov/"><img class="logoSDO" src="./assets/img/SDO-1600x400.jpg" alt="Department of Local Affairs Homepage"></a>
</div>
<div id="header-name">
<nav id="top-navigation-wrapper" style="display: block;">
<ul class="horiz">
<li class="horiz_item"> </li>
<li class="horiz_item"> <a href="https://cdola.colorado.gov/assessment-appeals">Assessment Appeals</a></li>
<li class="horiz_item"><a href="https://cdola.colorado.gov/housing">Housing</a></li>
<li class="horiz_item"> <a href="https://cdola.colorado.gov/local-government">Local Government</a></li>
<li class="horiz_item"> <a href="https://cdola.colorado.gov/property-taxation">Property Taxation</a></li>
</ul>
</nav>
</div>
<!-- First Grid, linked images -->
<div class="grid-container">
  <div class="grid-item panel_1_1">
			State Demography Office
			<br>The State Demography Office is the primary state agency for population and demographic information.
  </div>
  <div class="grid-item panel_2_1" id="leftHand">
	<div w3-include-html="./assets/html/left_hand.html"></div>
  </div> <!-- Grid  panel_2_1 -->

  <div class="grid-item panel_2_2">
	 <label for="county-dropdown">Select County:</label>
	 <select class="county-dropdown" id="county-dropdown"></select>
	 <p class="tbl-margin"></p>
     <div id="PopTab"></div>
	 <div id="RaceTab"></div>
   </div>
   <div class="grid-item panel_2_3">
   	 <p class="tbl-margin"></p>
	 <div id="COCTab"></div>
	 <div id="HousTab"></div>
   </div>
   <div class="grid-item panel_2_4">
	 <p class="tbl-margin"></p>
	 <div id="ACSTab"></div>
   </div>

<div class="grid-item panel_4_2">
			<div w3-include-html="./assets/html/bodycontent1.html"></div>
	 </div>
	<div class="grid-item panel_4_3">
			<div w3-include-html="./assets/html/bodycontent2.html"></div>
    </div>
	<div class="grid-item panel_4_4">
			<div w3-include-html="./assets/html/bodycontent3.html"></div>
	</div>
</div>  <!-- End Grid -->
<script>
//Setting HTML include and Accordion
includeHTML(); 

/* Populate County Dropdown */
popDropdown('county','county-dropdown')
	
//generating maximum year value for estimates
var urlstr = "https://gis.dola.colorado.gov/lookups/componentYRS";
d3.json(urlstr).then(function(yeardata){
    var maxest = yeardata.filter(function(d){return d.datatype == 'Estimate'});
	var yrsList = maxest.map(function(d){return d.year;});
    var yrvalue = d3.max(yrsList);
	
//Generate Initial Tables
genSYA("000",yrvalue);
genCOC("000",yrvalue);
genACS("000",yrvalue);
genRaceEth("000",yrvalue);
genHousing("000",yrvalue);


d3.select("#county-dropdown").on("change", function(d,i) {
        var selectedfips = d3.select("#county-dropdown").property('value');
		var selectedcounty = d3.select('#county-dropdown option:checked').text();

        genSYA(selectedfips,yrvalue);
		genCOC(selectedfips,yrvalue);
		genACS(selectedfips,yrvalue);
		genRaceEth(selectedfips,yrvalue);
		genHousing(selectedfips,yrvalue);
    });
}); //end of maximum year value

//Function checks if selected div is loaded and runs Accordion

window.onload = function() {
 var gridPanel = document.getElementById('leftHand');
 var accItem = gridPanel.getElementsByClassName('accordionItem');
 var accHD = gridPanel.getElementsByClassName('accordionItemHeading');
    for (i = 0; i < accHD.length; i++) {
        accHD[i].addEventListener('click', toggleItem, false);
    }
    function toggleItem() {
        var itemClass = this.parentNode.className;
        for (i = 0; i < accItem.length; i++) {
            accItem[i].className = 'accordionItem close';
        }
        if (itemClass == 'accordionItem close') {
            this.parentNode.className = 'accordionItem open';
        }
    };
}

</script>

</body>
</html> 